package require tcltest
set auto_path [list .. {*}$auto_path]
package require -exact msgpack 2.1.0

# Unpack nil

tcltest::test unpack-nil {unpack nil} -setup {
    set p [msgpack::unpacker new]
} -body {
    $p unpack_string \uC0
} -cleanup {
    $p destroy
} -returnCodes {ok} -result nil

# Unpack false

tcltest::test unpack-false {unpack false} -setup {
    set p [msgpack::unpacker new]
} -body {
    $p unpack_string \uC2
} -cleanup {
    $p destroy
} -returnCodes {ok} -result {{boolean 0}}

# Unpack true

tcltest::test unpack-true {unpack true} -setup {
    set p [msgpack::unpacker new]
} -body {
    $p unpack_string \uC3
} -cleanup {
    $p destroy
} -returnCodes {ok} -result {{boolean 1}}

# Unpack int

tcltest::test unpack-int {unpack int} -setup {
    set p [msgpack::unpacker new]
} -body {
    $p unpack_string \uD3\uFF\uFF\uFF\uFD\uAB\uF4\u1C\u00\uD2\uFF\u67\u69\u80\uD1\uD8\uF0\uD0\u9C\uF6\u0A\uD1\u27\u10\uD2\u00\u98\u96\u80\uD3\u00\u00\u00\u02\u54\u0B\uE4\u00
} -cleanup {
    $p destroy
} -returnCodes {ok} -result {{integer -10000000000} {integer -10000000} {integer -10000} {integer -100} {integer -10} {unsigned 10} {integer 10000} {integer 10000000} {integer 10000000000}}

# Unpack unsigned

tcltest::test unpack-unsigned {unpack unsigned} -setup {
    set p [msgpack::unpacker new]
} -body {
    $p unpack_string \u0a\uCC\uC8\uCD\u27\u10\uCE\u00\u98\u96\u80\uCF\u00\u00\u00\u02\u54\u0B\uE4\u00
} -cleanup {
    $p destroy
} -returnCodes {ok} -result {{unsigned 10} {unsigned 200} {unsigned 10000} {unsigned 10000000} {unsigned 10000000000}}

# cleanup
::tcltest::cleanupTests
return
